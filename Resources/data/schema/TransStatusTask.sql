<GetTotalTransCount>
SELECT COUNT(*)
FROM SAT011T
WHERE CD_STORE = @CD_STORE AND
		NO_POS = @NO_POS AND
		(CASE WHEN @DD_SALE = '' THEN 1 = 1
			ELSE DD_SALE = @DD_SALE END);
</GetTotalTransCount>
<GetUploadedTransCount>
SELECT COUNT(*)
FROM SAT011T
WHERE CD_STORE = @CD_STORE AND
		NO_POS = @NO_POS AND
		(CASE WHEN @DD_SALE = '' THEN 1 = 1
			ELSE DD_SALE = @DD_SALE END) AND
		FG_PRS = 'Y';
</GetUploadedTransCount>
<GetHoldTransCount>
SELECT COUNT(DISTINCT NO_BORU)
FROM SAT900T
WHERE FG_CANCEL = 'N' AND
		CD_STORE = @CD_STORE AND
		NO_POS = @NO_POS AND
		(CASE WHEN @DD_SALE = '' THEN 1 = 1
			ELSE DD_SALE = @DD_SALE END)
GROUP BY CD_STORE, NO_POS, DD_SALE
</GetHoldTransCount>
<GetLastUploadedDateImCompleted>
SELECT MIN(DD_SALE) AS DD_SALE
FROM SAT011T
WHERE CD_STORE = @CD_STORE AND
		NO_POS = @NO_POS AND 
		FG_PRS = 'N' LIMIT 1;
</GetLastUploadedDateImCompleted>